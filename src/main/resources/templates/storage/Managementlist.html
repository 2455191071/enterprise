<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>K101班</title>
    <link rel="stylesheet" href="../static/bots335/css/bootstrap.min.css" />
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="../static/bots335/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../static/css/know.css">
    <script src="../static/bots335/js/bootstrap.js" type="text/javascript"></script>
    <script src="../static/js/jquery-1.12.4.js" type="text/javascript"></script>
    <link href="../static/bots335/css/bootstrap.css" rel="stylesheet" />
    <style type="text/css">
        /* #tbStu tr th{background-color:#ccc;color:#fff}*/
        table tr{background:lavenderblush;}
    </style>
</head>
<body>
<style type="text/css">
    *{
        margin: 0;
        padding: 0;
    }
    table{
        background-color:#333;
        border-bottom:1px solid #777;
        width: 100%;
        height:35px;
    }
    ul{
        margin-top: 9px;
    }
    li {
        list-style: none;
        width: 50px;
        height: 30px;
        text-align: center;
        margin-left:-16px;
    }
    b{
        color: white;
        font-size:12px;
        font-family:"宋体";
    }
    .low-button{
        width:120px; /* 宽度 */
        height: 22px; /* 高度 */
        border-width: 0px; /* 边框宽度 */
        border-radius:5px; /* 边框半径 */
        background-color:#F0F0F0;
        font-size: 12px;
        margin-top: 3px;
    }

    .drop-button{
        width: 120px;
        height: 22px;
        border-width: 0px; /* 边框宽度 */
        border-radius:5px; /* 边框半径 */
        background-color:#F2F2F2;
        margin-top: 3px;
    }
    .axc{
        font-size: 12px;
        color: black;
        font-family:"宋体";
    }
    .dropdown-menu{
        background-color: steelblue;
        min-width:100%;
        border: 0px;
    }

</style>
<div class="row">
    <div class="col-sm-12">
        <table>
            <tr>
                <td>
                    <div style="padding:3px 0 0 3px;">
                        <img src="../static/bots335/img/1.jpg" border="0" />
                    </div>
                </td>
                <td>
                    <p style="color:#ddd; font-size: 12px;">
                        欢迎访问全管ERP+生产在线试用系统，试用其他产品点击如下链接：
                        <a href="http://oa.guanli360.com/" target="_blank">OA在线试用系统</a>、
                        <a href="http://crm.guanli360.com/" target="_blank">CRM在线试用系统</a>、
                        <a href="http://erp.guanli360.com/" target="_blank">ERP在线试用系统</a>
                    </p>
                </td>
                <td align="right" style="text-align:right;">
                    <div style="margin:4px 35px 0 0;">
                        <a title="计算器"><img src="../static/bots335/img/4.jpg" border="0" /></a>
                        <a title="农历（阴阳日历）"><img src="../static/bots335/img/1.jpg" border="0" /></a>
                    </div>
                </td>
                <td width="40">
                    <a title="注销退出" style="display:block;padding:4px 0 3px 6px;background-color:#900;border:1px solid #333;">
                        <img src="" border="0" style="display:block;" />
                    </a>
                </td>
            </tr>
        </table>
    </div>
    <div class="row">
        <div class="col-sm-2" style="width: 50px;height:600px;margin-left: 30px;background-color:dimgrey;">
            <img src="../static/bots335/img/2.jpg" />
            <ul>
                <li><a><b>办公</b></a></li>
                <li><a><b>交流</b></a></li>
                <li><a><b>销售</b></a></li>
                <li><a><b>采购</b></a></li>
                <li><a><b>仓储</b></a></li>
                <li><a><b>项目</b></a></li>
                <li><a><b>生产</b></a></li>
                <li><a><b>服务</b></a></li>
                <li><a><b>后勤</b></a></li>
                <li><a><b>人事</b></a></li>
                <li><a><b>财务</b></a></li>
                <li><a><b>报表</b></a></li>
                <li><a><b>系统</b></a></li>
            </ul>
            <img src="../static/bots335/img/7.jpg" />
        </div>
        <div class="col-sm-3" style="background-color: steelblue;width: 150px; height: 600px;">
            <div class="low">

            </div>
            <div class="col-sm-3" style="background-color:lemonchiffon;width:1335px; height: 600px;" id="welcome" >
                <div class="container">

                    <h3>库存流水管理表信息</h3>
                    <form action="/man/list" method="post">

                        <div class="row">
                            <div class="col-sm--1"></div>
                            <div class="col-sm-4">商品物料：
                                <input type="text"  name="commodityId" id="commodityId"/>

                            </div>
                            <div class="col-sm--1"></div>
                            <div class="col-sm-8">日期：
                                <input type="date"  name="managementDate" id="managementDate"/>--<input type="date"  name="Date" id="Date"/>
                            </div>
                        </div><br>
                        <div class="row">
                            <div class="col-sm--1"></div>
                            <div class="col-sm-4">仓库：
                                <input type="text"  name="wareId" id="wareId"/>
                                <a href="/depo/doplist"><img src="../static/bots335/img/r5.png" style="width: 30px;height: 30px;"></a>
                            </div>

                            <div class="col-sm-8"></div>
                            <div class="col-sm--2">
                                <input class="btn btn-info" type="submit" value="查询"/>
                                <input class="btn btn-info" type="submit" id="qk" value="清空查询"/>
                                <button type="button" class="btn btn-info" id="excell" onclick="method5('dataTable')">导出exe表格</button>
                            </div>

                        </div>
                    </form>	<br/>

                    <div class="row">
                        <div class="col-sm-12">
                            <table class="table table-bordered table-hover" id="dataTable">
                                <tr class="info">
                                    <th>编号</th>
                                    <th>日期好时间</th>
                                    <th>商品物料</th>
                                    <th>仓库</th>
                                    <th>期初数量</th>
                                    <th>入库数量</th>
                                    <th>出库数量</th>
                                    <th>期末数量</th>
                                    <th>期初数量</th>
                                    <th>入库金额</th>
                                    <th>出库金额</th>
                                    <th>期末金额</th>
                                    <th>成本单价</th>
                                    <th>来源数据</th>
                                    <th>备注</th>

                                </tr>
                                <tr th:each="les :${manlist.list }">
                                    <td th:text="${les.managementId}"></td>
                                    <td th:text="${les.managementDate}"></td>
                                    <td th:text="${les.commodityId}"></td>
                                    <td th:text="${les.wareId.department}"></td>
                                    <td th:text="${les.managementQuant}"></td>
                                    <td th:text="${les.wareId.fanumber}"></td>
                                    <td th:text="${les.wareId.shounumber}"></td>
                                    <td th:text="${les.wareId.fanumber}"></td>
                                    <td th:text="${les.managementQuant}"></td>

                                    <td th:text="${les.managementAmo}"></td>
                                    <td th:text="${les.managementCost}"></td>
                                    <td th:text="${les.managementAmo}"></td>
                                    <td th:text="${les.managementCost}"></td>
                                    <td th:text="${les.managementCome}"></td>
                                    <td th:text="${les.managementBei}"></td>

                                </tr>

                            </table>
                        </div>
                        </table>
                        <div class="row">
                            <div class="col-sm-4"></div>
                            <div class="col-sm-5">
                                <ul class="pagination">

                                    <li><a th:href="@{/man/list(index=1)}">首页</a> </li>

                                    <li><span th:switch="${manlist.pageIndex}">
                                        <a th:case="1" th:href="@{/man/list(index=1)}">上一页</a>
                                        <a th:case="*" th:href="@{/man/list(index=${manlist.pageIndex-1})}">上一页</a>
                                        </span>
                                    </li>

                                    <li>
                                        <span th:switch="${manlist.pageIndex}">
                                        <a th:case="${manlist.pageNumber}" th:href="@{/man/list(index=${manlist.pageNumber})}">下一页</a>
                                        <a th:case="*" th:href="@{/man/list(index=${manlist.pageIndex+1})}">下一页</a>
                                        </span>
                                    </li>
                                    <li><a th:href="@{/man/list(index=${manlist.pageNumber})}">尾页</a></li>

                                  <!--  <li><a th:href="@{list?index=1}">首页</a></li>
                                    <li> <a th:href="@{list?(index=${manlist.pageIndex>1?manlist.pageIndex-1:1})}">上一页</a></li>
                                    <li> <a th:href="@{list?(index=${manlist.pageIndex<manlist.pageNumber?manlist.pageIndex+1:manlist.pageNumber})}">下一页</a></li>
                                    <li><a th:href="@{list?(index=${manlist.pageNumber})}">末页</a></li>-->
                                    &nbsp;  &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                    第<span th:text="${manlist.pageIndex}"></span>页/共<span th:text="${manlist.pageNumber}"></span>页
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    $("#qk").click(function(){
        $("#commodityId").val("");
        $("#managementDate").val("");
        $("#Date").val("");
        $("#wareId").val("");

    })
</script>
<script>
    //打印表格
    var idTmr;

    function getExplorer() {
        var explorer = window.navigator.userAgent;
        //ie
        if(explorer.indexOf("MSIE") >= 0) {
            return 'ie';
        }
        //firefox
        else if(explorer.indexOf("Firefox") >= 0) {
            return 'Firefox';
        }
        //Chrome
        else if(explorer.indexOf("Chrome") >= 0) {
            return 'Chrome';
        }
        //Opera
        else if(explorer.indexOf("Opera") >= 0) {
            return 'Opera';
        }
        //Safari
        else if(explorer.indexOf("Safari") >= 0) {
            return 'Safari';
        }
    }

    function method5(tableid) {
        if(getExplorer() == 'ie') {
            var curTbl = document.getElementById(tableid);
            var oXL = new ActiveXObject("Excel.Application");
            var oWB = oXL.Workbooks.Add();
            var xlsheet = oWB.Worksheets(1);
            var sel = document.body.createTextRange();
            sel.moveToElementText(curTbl);
            sel.select();
            sel.execCommand("Copy");
            xlsheet.Paste();
            oXL.Visible = true;

            try {
                var fname = oXL.Application.GetSaveAsFilename("Excel.xls",
                    "Excel Spreadsheets (*.xls), *.xls");
            } catch(e) {
                print("Nested catch caught " + e);
            } finally {
                oWB.SaveAs(fname);
                oWB.Close(savechanges = false);
                oXL.Quit();
                oXL = null;
                idTmr = window.setInterval("Cleanup();", 1);
            }

        } else {
            tableToExcel(tableid)
        }
    }

    function Cleanup() {
        window.clearInterval(idTmr);
        CollectGarbage();
    }
    var tableToExcel = (function() {
        var uri = 'data:application/vnd.ms-excel;base64,',
            template = '<html><head><meta charset="UTF-8"></head><body><table  border="1">{table}</table></body></html>',
            base64 = function(
                s) {
                return window.btoa(unescape(encodeURIComponent(s)))
            },
            format = function(s, c) {
                return s.replace(/{(\w+)}/g, function(m, p) {
                    return c[p];
                })
            }
        return function(table, name) {
            if(!table.nodeType)
                table = document.getElementById(table)
            var ctx = {
                worksheet: name || 'Worksheet',
                table: table.innerHTML
            }
            window.location.href = uri + base64(format(template, ctx))
        }
    })()
</script>
</html>